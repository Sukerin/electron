<script>

    // const moment = require("moment");
    // const Wind = require("${__dirname}/libs/wind");

    const {ipcRenderer} = require('electron')

    ipcRenderer.on('message-from-renderer', (event, arg) => {
        const XLSX = require('xlsx');
        let workbook = XLSX.readFile(arg);
        let first_sheet_name = workbook.SheetNames[0];
        let worksheet = workbook.Sheets[first_sheet_name];
        let rawExcelData = XLSX.utils.sheet_to_json(worksheet, {header: ["A", "B", "C", "D", "year", "month", "day", "hour", "wd"]}) ?? [];
        if (Object.is(rawExcelData.length, 0)) return;
        // let xxx = Array.from(sortData(rawExcelData, 'year').values());
        // let xxx = Array.from(sortData(rawExcelData, 'year').values());
        // console.log(xxx)
        ipcRenderer.send('message-from-worker', rawExcelData);
    })

    // function sortData(rawData, type) {
    //     let format;
    //     switch (type) {
    //         case 'year':
    //             format = 'yyyy';
    //             break;
    //         case 'quarter':
    //             format = 'yyyy-第Q季度';
    //             break;
    //         case 'month':
    //             format = 'yyyy-MM';
    //             break;
    //         default :
    //             format = 'yyyy'
    //     }
    //     let map = new Map();
    //     for (let value of rawData.values()) {
    //         let {year, month, wd} = value;
    //         let date = moment().year(year).month(month - 1);
    //         let ym = date.format(format);
    //         let wind;
    //         if (map.has(ym)) {
    //             wind = map.get(ym);
    //         } else {
    //             wind = new Wind();
    //             map.set(ym, wind);
    //             wind.year = year;
    //             wind.month = month;
    //             wind.sDateTime = ym;
    //         }
    //         if (wind.windDirectionCount[wd] !== undefined) {
    //             wind.windDirectionCount[wd] = wind.windDirectionCount[wd] + 1;
    //         }
    //     }
    //     return map;
    // }


</script>
